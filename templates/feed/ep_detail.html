{% extends 'base_nav.html' %}
{% load static %}
{% block title %}Episode Detail{% endblock %}

{% block content %}
{% static "" as STATIC_URL %}
<script>
$(function() {
    $('#ajax').on('click', function() {
        $('#result').html('<p>返ってきている</p>');
        $.ajax({
            'url':'{% url "feed:add_like" %}',
            'type':'GET',
            'data':{
                'ep_id':$('#ep_id').val(),
            },
            'dataType':'json',
            'done':function(data){
                $('#result').append('<p>'+ '返ってきた' +'</p>')
            },
            'fail':function(data){
                $('#result').append('<p>'+ 'errorrrrrrrrrrrrrrrrrrrrrr' +'</p>')
            },
        });
        return false;
    });
});
</script>
<div id="wrapper">
  <div id="page-wrapper">
    <div class="row">
      <div class="col-lg-12 full-width margin-top-20percent">
        {% if episode %}
        <h3>{{ episode.title }}</h3>
            <div class="panel-body">
            <img src="{{ STATIC_URL }}{{ episode.channel.cover_image }}" width=150px/>
            </div>
            {% if like %}
              <p><button type="button" class="btn btn-primary btn-xs">Likeから除外する</button></p>
            {% else %}
              <p><button type="button" id="ajax" class="btn btn-primary btn-xs" >Like</button></p>
                <form id="like" action="" method="GET">
                  <input type="hidden" id="ep_id" name="ep_id" value="{{ episode.id }}">

                </form>
            {% endif %}
            <div id="result">
              {{ result }}
            </div>
            <p>{{ episode.description }}</p>
            <p>{{ episode.link }}</p>
            <p>{{ episode.release_date }}</p>
            <p>{{ episode.duration }}</p>
            <p>Channel: {{ episode.channel.title }}</p>
        {% else %}
            <p>エピソード情報が取得できませんでした</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
